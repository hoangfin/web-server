# WebServ Configuration File

# Define a server block
server {
    # Server host and port configuration
    listen 127.0.0.1:8080;         # Host and Port
    server_name localhost;         # Server name (optional)

    # Default error pages
    error_page 404 /errors/404.html;
    error_page 500 /errors/500.html;

    # Limit client body size
    client_max_body_size 10M;      # Maximum request body size (in bytes)

    # Define routes
    # Root directory route
    location / {
        root /var/www/html;        # Root directory for the server
        index index.html;          # Default file for directories
        autoindex off;             # Directory listing off
        methods GET POST;          # Allowed HTTP methods
    }

    # Example of a route with redirection
    location /redirect {
        return 301 http://example.com;  # Redirect to another URL
    }

    # Static file serving
    location /static/ {
        root /var/www/static;      # Static files directory
        autoindex on;              # Enable directory listing
        methods GET;               # Only GET is allowed
    }

    # CGI configuration for .php files
    location /cgi-bin/ {
        root /var/www/cgi-bin;     # Root directory for CGI scripts
        cgi_extension .php;        # File extension to execute with CGI
        methods GET POST;          # Allowed methods for CGI
        upload_dir /var/www/uploads; # Directory for uploaded files
    }

    # File upload route
    location /upload {
        root /var/www/uploads;     # Directory to save uploaded files
        methods POST;              # Only POST is allowed
        upload_dir /var/www/uploads;
    }
}

# A second server for demonstration purposes
server {
    listen 127.0.0.1:9090;         # Different port
    server_name second-server;     # Optional server name

    root /var/www/second;          # Root directory for this server
    index index.html;              # Default file
    autoindex off;                 # Directory listing disabled

    # Default error pages
    error_page 404 /errors/404.html;
    error_page 403 /errors/403.html;
}
