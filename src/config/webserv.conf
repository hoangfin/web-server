# WebServ Configuration File

server {
    # Listen on localhost:8080
    host 127.0.0.1;
    port 8080;
    server_name default;

    # Default error pages
    error_page_404 /errors/404.html;
    error_page_500 /errors/500.html;

    # Limit client body size
    client_max_body_size 10000000;

    # Define routes
    # Root directory route
    location / {
        root var/www/html;           # Root directory relative to src/config/
        index index.html;            # Default file for directories
        autoindex off;               # Directory listing off
        methods GET POST;            # Allowed HTTP methods
    }

    # Static files route
    location /static/ {
        root var/www/static;         # Relative path to static files
        index index.html;            # Default file for directories
        autoindex on;                # Enable directory listing
        methods GET;                 # Only GET is allowed
    }

    # CGI configuration for .php files
    location /cgi-bin/ {
        root var/www/cgi-bin;        # CGI scripts directory
        cgi_extension .php;          # CGI files with .php extension
        methods GET POST;            # Allowed methods for CGI
        upload_dir var/www/uploads;  # Directory for uploaded files
    }

    # File upload route
    location /upload {
        root var/www/uploads;        # Directory for file uploads
        methods POST;                # Only POST is allowed
        upload_dir var/www/uploads;  # Directory to save uploaded files
    }

    # Redirect example
    location /redirect {
        return 301 http://example.com;  # Redirect requests to this URL
    }
}

# Error pages
location /errors/ {
    root errors;  # Directory for error pages relative to src/config/
}
